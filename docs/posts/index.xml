<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
    <channel>
        <title>Posts on 新泽雪冬</title>
        <link>https://blog.zooter.com.cn/posts/</link>
        <description>Recent content in Posts on 新泽雪冬</description>
        <generator>Hugo -- gohugo.io</generator>
        <language>zh-cn</language>
        <lastBuildDate>Wed, 16 Mar 2022 20:10:15 -0700</lastBuildDate><atom:link href="https://blog.zooter.com.cn/posts/index.xml" rel="self" type="application/rss+xml" /><item>
        <title>IPv6入门</title>
        <link>https://blog.zooter.com.cn/posts/ipv6%E5%85%A5%E9%97%A8/</link>
        <pubDate>Wed, 16 Mar 2022 20:10:15 -0700</pubDate>
        
        <guid>https://blog.zooter.com.cn/posts/ipv6%E5%85%A5%E9%97%A8/</guid>
        <description>&lt;h1 id=&#34;ipv6入门&#34;&gt;IPv6入门&lt;/h1&gt;
&lt;h2 id=&#34;1-特点&#34;&gt;1. 特点&lt;/h2&gt;
&lt;p&gt;网际协议第6版(Internet Protocol version 6)是网际协议的最新版本，用它来取代IPv4，解决IPv4地址枯竭的问题。它在很多方面对于IPv4进行了改进。&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;IPv6采用128位标志，可提供近乎无限的地址空间。&lt;/li&gt;
&lt;li&gt;IPv6去除了IPv4中不常用的标志头，且提出了扩展头的概念，使报文得到简化，降低了性能消耗。&lt;/li&gt;
&lt;li&gt;IPv6支持通过地址自动配置方式使主机自动发现网络并获取IPv6地址。&lt;/li&gt;
&lt;li&gt;IPv6网络层支持IPsec认证和加密，支持端到端的安全。&lt;/li&gt;
&lt;li&gt;IPv6增加了流标志域，提供了QOS支持。&lt;/li&gt;
&lt;li&gt;IPv6优化了对移动设备的支持。&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;2-对比ipv4&#34;&gt;2. 对比IPv4&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;采用128位长度，可提供近乎无限的地址&lt;/li&gt;
&lt;li&gt;优化了报头，性能更优，且具有扩展性&lt;/li&gt;
&lt;li&gt;主机可自主发现网络并配置IP地址，可不依赖DHCP服务&lt;/li&gt;
&lt;li&gt;地址空间巨大可进行更合理的层次化网络部署，以方便进行路由聚合，提高路由转发效率&lt;/li&gt;
&lt;li&gt;网络层支持IPSec，实现端到端的安全&lt;/li&gt;
&lt;li&gt;增加了流标志域，提供Qos保障，可区分实时流量，不同的流标签+源地址可以唯一确定一条数据流，中间网络设备可以根据这些信息更加高效率的区分数据流。&lt;/li&gt;
&lt;li&gt;对移动网络优化，邻居发现和可扩展报头解决了IPv4的三角路由、源地址过滤问题&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;3-地址&#34;&gt;3. 地址&lt;/h2&gt;
&lt;h3 id=&#34;31-地址格式&#34;&gt;3.1 地址格式&lt;/h3&gt;
&lt;p&gt;IPv6采用128位来标志，16位为一组，用&amp;quot;:&amp;ldquo;隔开，分为8组，每组用4位十六进制数表示。&lt;/p&gt;
&lt;p&gt;一个IPv6的地址可以分为两个部分：&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;网络前缀：n位，类似IPv4中的网络ID&lt;/li&gt;
&lt;li&gt;接口标识：128-n位，类似IPv4中的主机ID&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;同时IPv6在某些条件下可以省略：&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;每项数字前导的0可以省略，省略后前导数字仍是0则继续，例如下组IPv6是等价的。
&lt;ul&gt;
&lt;li&gt;2001:&lt;strong&gt;0&lt;/strong&gt;db8:&lt;strong&gt;0&lt;/strong&gt;2de:&lt;strong&gt;0000&lt;/strong&gt;:&lt;strong&gt;0000&lt;/strong&gt;:&lt;strong&gt;0000&lt;/strong&gt;:&lt;strong&gt;0000&lt;/strong&gt;:&lt;strong&gt;0&lt;/strong&gt;e13&lt;/li&gt;
&lt;li&gt;2001:db8:2de:&lt;strong&gt;0000&lt;/strong&gt;:&lt;strong&gt;0000&lt;/strong&gt;:&lt;strong&gt;0000&lt;/strong&gt;:&lt;strong&gt;0000&lt;/strong&gt;:e13&lt;/li&gt;
&lt;li&gt;2001:db8:2de:&lt;strong&gt;000&lt;/strong&gt;:&lt;strong&gt;000&lt;/strong&gt;:&lt;strong&gt;000&lt;/strong&gt;:&lt;strong&gt;000&lt;/strong&gt;:e13&lt;/li&gt;
&lt;li&gt;2001:db8:2de:&lt;strong&gt;00&lt;/strong&gt;:&lt;strong&gt;00&lt;/strong&gt;:&lt;strong&gt;00&lt;/strong&gt;:&lt;strong&gt;00&lt;/strong&gt;:e13&lt;/li&gt;
&lt;li&gt;2001:db8:2de:&lt;strong&gt;0&lt;/strong&gt;:&lt;strong&gt;0&lt;/strong&gt;:&lt;strong&gt;0&lt;/strong&gt;:&lt;strong&gt;0&lt;/strong&gt;:e13&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;可以用双冒号“::”表示一组0或多组连续的0，但只能出现一次：
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;如果四组数字都是零，可以被省略。遵照以上省略规则，下面这两组IPv6都是相等的。&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;2001:db8:2de:&lt;strong&gt;0&lt;/strong&gt;:&lt;strong&gt;0&lt;/strong&gt;:&lt;strong&gt;0&lt;/strong&gt;:&lt;strong&gt;0&lt;/strong&gt;:e13&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;2001:db8:2de**::**e13&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;2001:0db8:&lt;strong&gt;0000&lt;/strong&gt;:&lt;strong&gt;0000&lt;/strong&gt;:&lt;strong&gt;0000&lt;/strong&gt;:&lt;strong&gt;0000&lt;/strong&gt;:1428:57ab&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;2001:0db8:&lt;strong&gt;0000&lt;/strong&gt;:&lt;strong&gt;0000&lt;/strong&gt;:&lt;strong&gt;0000&lt;/strong&gt;::1428:57ab&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;2001:0db8:&lt;strong&gt;0&lt;/strong&gt;:&lt;strong&gt;0&lt;/strong&gt;:&lt;strong&gt;0&lt;/strong&gt;:&lt;strong&gt;0&lt;/strong&gt;:1428:57ab&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;2001:0db8:&lt;strong&gt;0&lt;/strong&gt;::&lt;strong&gt;0&lt;/strong&gt;:1428:57ab&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;2001:0db8**::**1428:57ab&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;2001**::&lt;strong&gt;25de&lt;/strong&gt;::**cade 是非法的，因为双冒号出现了两次。它有可能是下种情形之一，造成无法推断。&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;2001:0000:0000:0000:0000:25de:0000:cade&lt;/li&gt;
&lt;li&gt;2001:0000:0000:0000:25de:0000:0000:cade&lt;/li&gt;
&lt;li&gt;2001:0000:0000:25de:0000:0000:0000:cade&lt;/li&gt;
&lt;li&gt;2001:0000:25de:0000:0000:0000:0000:cade&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;如果这个地址实际上是IPv4的地址，后32位可以用10进制数表示；因此::ffff:192.168.89.9 相等于::ffff:c0a8:5909。&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id=&#34;32-分类&#34;&gt;3.2 分类&lt;/h3&gt;
&lt;p&gt;&lt;img src=&#34;https://blog.zooter.com.cn/posts/ipv6%E5%85%A5%E9%97%A8/d63bbf16f30d7cae0f9fb4055e21ff6f.png&#34;
	width=&#34;897&#34;
	height=&#34;752&#34;
	srcset=&#34;https://blog.zooter.com.cn/posts/ipv6%E5%85%A5%E9%97%A8/d63bbf16f30d7cae0f9fb4055e21ff6f_hu8ba9a5764594cebdbc6198a4a0750658_50613_480x0_resize_box_3.png 480w, https://blog.zooter.com.cn/posts/ipv6%E5%85%A5%E9%97%A8/d63bbf16f30d7cae0f9fb4055e21ff6f_hu8ba9a5764594cebdbc6198a4a0750658_50613_1024x0_resize_box_3.png 1024w&#34;
	loading=&#34;lazy&#34;
	
		alt=&#34;地址分类&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;119&#34;
		data-flex-basis=&#34;286px&#34;
	
&gt;&lt;/p&gt;
&lt;h4 id=&#34;321-全球单播地址&#34;&gt;3.2.1 全球单播地址&lt;/h4&gt;
&lt;p&gt;&lt;img src=&#34;https://blog.zooter.com.cn/posts/ipv6%E5%85%A5%E9%97%A8/cb20aa2d0b5e37057010f08dad701ae5.png&#34;
	width=&#34;872&#34;
	height=&#34;234&#34;
	srcset=&#34;https://blog.zooter.com.cn/posts/ipv6%E5%85%A5%E9%97%A8/cb20aa2d0b5e37057010f08dad701ae5_hu8c27b932417cf0ff49e33fee0068ef4a_50536_480x0_resize_box_3.png 480w, https://blog.zooter.com.cn/posts/ipv6%E5%85%A5%E9%97%A8/cb20aa2d0b5e37057010f08dad701ae5_hu8c27b932417cf0ff49e33fee0068ef4a_50536_1024x0_resize_box_3.png 1024w&#34;
	loading=&#34;lazy&#34;
	
		alt=&#34;全球单播地址&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;372&#34;
		data-flex-basis=&#34;894px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;全球单播地址(GUA，Global Unicast Addresses )是带有全球单播前缀的IPv6地址，地址空间为2000::/3，其作用类似于IPv4中的公网地址。
全球单播地址由全球路由前缀（Global routing prefix）、子网ID（Subnet ID）和接口标识（Interface ID）组成：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Global routing prefix：全球路由前缀。由提供商（Provider）指定给一个组织机构，通常全球路由前缀至少为48位。目前已经分配的全球路由前缀的前3bit均为001。&lt;/li&gt;
&lt;li&gt;Subnet ID：子网ID。组织机构可以用子网ID来构建本地网络（Site）。子网ID通常最多分配到第64位。子网ID和IPv4中的子网号作用相似。&lt;/li&gt;
&lt;li&gt;Interface ID：接口标识。用来标识一个设备（Host）。&lt;/li&gt;
&lt;/ul&gt;
&lt;h5 id=&#34;单播地址配置&#34;&gt;单播地址配置&lt;/h5&gt;
&lt;p&gt;有无状态仅针对IPv6地址分配，不包含其他参数。&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;有状态：地址可控，可管理，可实现类似IPv4 DHCP申请租约、续租的功能。&lt;/li&gt;
&lt;li&gt;无状态：地址不可控，难管理，网络中只有网关，每个客户端发送RA报文(邻居发现协议)自行配置地址。&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;除了手动配置外，还可以采用自动配置（默认认为接口已自动生成链路本地地址）。自动配置分为以下几种方式：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;无状态&lt;/p&gt;
&lt;p&gt;发送RS报文，根据网关回应的RA报文(邻居发现协议)中的前缀自动配置地址（前缀+EUI-64或随机）&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;无状态DHCPv6&lt;/p&gt;
&lt;p&gt;地址依然通过RA、RS报文生成。其他参数如DNS，从DHCPv6服务器获取。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;有状态DHCPv6&lt;/p&gt;
&lt;p&gt;地址、DNS等信息都从DHCPv6服务器获取。&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;img src=&#34;https://blog.zooter.com.cn/posts/ipv6%E5%85%A5%E9%97%A8/60e243e3dfe4374df9dd6e2197c9386e.png&#34;
	width=&#34;1372&#34;
	height=&#34;1920&#34;
	srcset=&#34;https://blog.zooter.com.cn/posts/ipv6%E5%85%A5%E9%97%A8/60e243e3dfe4374df9dd6e2197c9386e_hu6382e57bbbe1ac5bc8fb4bddcc78c8fc_506818_480x0_resize_box_3.png 480w, https://blog.zooter.com.cn/posts/ipv6%E5%85%A5%E9%97%A8/60e243e3dfe4374df9dd6e2197c9386e_hu6382e57bbbe1ac5bc8fb4bddcc78c8fc_506818_1024x0_resize_box_3.png 1024w&#34;
	loading=&#34;lazy&#34;
	
		alt=&#34;寻址方式&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;71&#34;
		data-flex-basis=&#34;171px&#34;
	
&gt;&lt;/p&gt;
&lt;h4 id=&#34;322-链路本地地址&#34;&gt;3.2.2 链路本地地址&lt;/h4&gt;
&lt;p&gt;&lt;img src=&#34;https://blog.zooter.com.cn/posts/ipv6%E5%85%A5%E9%97%A8/3d76120b1e5f31faf151847749f72c45.png&#34;
	width=&#34;716&#34;
	height=&#34;264&#34;
	srcset=&#34;https://blog.zooter.com.cn/posts/ipv6%E5%85%A5%E9%97%A8/3d76120b1e5f31faf151847749f72c45_hufe9863f22203d94d908c5309174623c7_26314_480x0_resize_box_3.png 480w, https://blog.zooter.com.cn/posts/ipv6%E5%85%A5%E9%97%A8/3d76120b1e5f31faf151847749f72c45_hufe9863f22203d94d908c5309174623c7_26314_1024x0_resize_box_3.png 1024w&#34;
	loading=&#34;lazy&#34;
	
		alt=&#34;链路本地地址&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;271&#34;
		data-flex-basis=&#34;650px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;链路本地地址(LLA，Link-Local Addresses)是IPv6中的应用范围受限制的地址类型，具有以下特点：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;只能在连接到同一本地网络的设备之间使用；&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;设备采用地址冲突检测机制来保证该地址在本地网络中的唯一性；&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;设备每个接口有且仅有一个链路本地地址；&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;目的地址为链路本地地址的数据包将不会被路由；&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;链路本地地址的前缀为&lt;code&gt;FE80::/10&lt;/code&gt;，同时将接口标识添加在后面作为地址的低64比特。&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h5 id=&#34;链路本地地址配置&#34;&gt;链路本地地址配置&lt;/h5&gt;
&lt;h6 id=&#34;eui-64规则&#34;&gt;EUI-64规则&lt;/h6&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;在48位MAC地址中间插入16位固定值FFFE。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;把第7位取反。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;加上前缀。&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;&lt;img src=&#34;https://blog.zooter.com.cn/posts/ipv6%E5%85%A5%E9%97%A8/f6a563180903dc9f551c57ccf136d236.png&#34;
	width=&#34;692&#34;
	height=&#34;158&#34;
	srcset=&#34;https://blog.zooter.com.cn/posts/ipv6%E5%85%A5%E9%97%A8/f6a563180903dc9f551c57ccf136d236_hu782db09b238dca8b083e1ae0b1a7e084_25412_480x0_resize_box_3.png 480w, https://blog.zooter.com.cn/posts/ipv6%E5%85%A5%E9%97%A8/f6a563180903dc9f551c57ccf136d236_hu782db09b238dca8b083e1ae0b1a7e084_25412_1024x0_resize_box_3.png 1024w&#34;
	loading=&#34;lazy&#34;
	
		alt=&#34;EUI-64规则&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;437&#34;
		data-flex-basis=&#34;1051px&#34;
	
&gt;&lt;/p&gt;
&lt;h6 id=&#34;eui-48规则&#34;&gt;EUI-48规则&lt;/h6&gt;
&lt;p&gt;直接在48位MAC地址加上前缀，现已弃用。&lt;/p&gt;
&lt;h4 id=&#34;323-本地唯一地址&#34;&gt;3.2.3 本地唯一地址&lt;/h4&gt;
&lt;p&gt;&lt;img src=&#34;https://blog.zooter.com.cn/posts/ipv6%E5%85%A5%E9%97%A8/2d50024baee34e9356ab3635205b88e9.png&#34;
	width=&#34;687&#34;
	height=&#34;212&#34;
	srcset=&#34;https://blog.zooter.com.cn/posts/ipv6%E5%85%A5%E9%97%A8/2d50024baee34e9356ab3635205b88e9_huc5e705835f17c88ab85c406d301fcb7c_34980_480x0_resize_box_3.png 480w, https://blog.zooter.com.cn/posts/ipv6%E5%85%A5%E9%97%A8/2d50024baee34e9356ab3635205b88e9_huc5e705835f17c88ab85c406d301fcb7c_34980_1024x0_resize_box_3.png 1024w&#34;
	loading=&#34;lazy&#34;
	
		alt=&#34;本地唯一地址&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;324&#34;
		data-flex-basis=&#34;777px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;本地唯一地址(ULA:Unique Local Address)是另一种应用范围受限的地址，它仅能在一个站点内使用。由于本地站点地址的废除（RFC3879），唯一本地地址被用来代替本地站点地址。这类地址划分成两个/8组： &lt;code&gt;fc00::/8&lt;/code&gt;保留尚未定义，&lt;code&gt;fd00::/8&lt;/code&gt;可以使用，具体使用时可以随机生成40位的前缀，与/8一起组成48位前缀，后面还是一样，16位子网+64位接口地址。&lt;/p&gt;
&lt;p&gt;唯一本地地址的作用类似于IPv4中的私网地址&lt;code&gt;10.0.0.0/8&lt;/code&gt;、&lt;code&gt;172.16.0.0/12&lt;/code&gt;和&lt;code&gt;192.168.0.0/16&lt;/code&gt;，任何没有申请到提供商分配的全球单播地址的组织机构都可以使用唯一本地地址。唯一本地地址只能在本地网络内部被路由转发而不会在全球网络中被路由转发。&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;设有ULA的设备既不能访问Internet，也不能被Internet上的设备访问。——《IPv6技术精要》4.4.5&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h4 id=&#34;324-回环地址&#34;&gt;3.2.4 回环地址&lt;/h4&gt;
&lt;p&gt;&lt;code&gt;::1/128&lt;/code&gt;－是一种单播绕回地址。如果一个应用程序将数据包送到此地址，IPv6堆栈会转送这些数据包绕回到同样的虚拟接口（相当于IPv4中的&lt;code&gt;127.0.0.1/8&lt;/code&gt;）。&lt;/p&gt;
&lt;h4 id=&#34;325-未指定地址&#34;&gt;3.2.5 未指定地址&lt;/h4&gt;
&lt;p&gt;&lt;code&gt;::/128&lt;/code&gt;－所有比特皆为零的地址称作未指定地址。&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;这个地址不可指定给某个网络接口；&lt;/li&gt;
&lt;li&gt;数据包源地址为未指定地址时，表示源设备接口的IPv6地址暂缺；&lt;/li&gt;
&lt;li&gt;路由器不可转发包含未指定地址的数据包；&lt;/li&gt;
&lt;li&gt;未指定地址会用于IMCPv6冲突地址检测机制中，作为某些ICMPv6消息的源地址。&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id=&#34;326-嵌入ipv4的ipv6地址&#34;&gt;3.2.6 嵌入IPv4的IPv6地址&lt;/h4&gt;
&lt;p&gt;双栈设备可使用嵌入IPv4的IPv6地址与IPv4和IPv6网络进行交互。这类地址的前80位全部置0，接下来的16位全部置1，最后32位填充IPv4地址，可用点分十进制来表示。例如：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;0000:0000:0000:0000:0000:ffff:206.123.31.2&lt;/li&gt;
&lt;li&gt;0000:0000:0000:0000:0000:ffff:ce7b:1f01&lt;/li&gt;
&lt;li&gt;0:0:0:0:0:ffff:ce7b:1f01&lt;/li&gt;
&lt;li&gt;::ffff:ce7b:1f01&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;33-guaulalla对比&#34;&gt;3.3 GUA/ULA/LLA对比&lt;/h3&gt;
&lt;p&gt;GUA：Global Unicast Addresses全球单播地址&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;一个接口可有多个全球单播地址&lt;/li&gt;
&lt;li&gt;在获取全球单播地址前，必须生成链路本地地址&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;ULA：Unique Local Address本地唯一地址&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;使用方式类似于GUA，在网络合并或私自互联时，不会发生地址冲突问题，也无须重编址(地址空间巨大，冲突可能性极小)&lt;/li&gt;
&lt;li&gt;设有ULA的设备不能访问Internet，也不能被Internet上其他设备访问&lt;/li&gt;
&lt;li&gt;用于仅在本地工作的设备，例如：打印机、门铃、开关等&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;LLA：Link-Local Addresses链路本地地址&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;每个支持IPv6协议的接口有且仅有唯一一个链路本地地址，采用地址冲突检测机制保证在&lt;strong&gt;链路本地&lt;/strong&gt;的唯一性(多个接口在不同链路中可以使用相同的链路本地地址)&lt;/li&gt;
&lt;li&gt;目的地址为链路本地地址的数据包将不会被路由，即仅在本网段内生效&lt;/li&gt;
&lt;/ul&gt;
</description>
        </item>
        <item>
        <title>Iptables简介</title>
        <link>https://blog.zooter.com.cn/posts/iptables%E7%AE%80%E4%BB%8B/</link>
        <pubDate>Wed, 16 Mar 2022 19:46:25 -0700</pubDate>
        
        <guid>https://blog.zooter.com.cn/posts/iptables%E7%AE%80%E4%BB%8B/</guid>
        <description>&lt;h1 id=&#34;iptables简介&#34;&gt;iptables简介&lt;/h1&gt;
&lt;h2 id=&#34;1-iptables&#34;&gt;1. iptables&lt;/h2&gt;
&lt;p&gt;iptables是运行在用户空间的软件，通过控制内核中的netfilter模块来实现对网络的管理。实际上我们只是通过iptables来对内核中的netfilter的规则进行修改，netfilter才是实际工作的模块。&lt;/p&gt;
&lt;p&gt;通常来说iptables仅用于处理IPv4数据包，对于IPv6需要使用ip6tables命令。&lt;/p&gt;
&lt;h2 id=&#34;2-netfilter&#34;&gt;2. netfilter&lt;/h2&gt;
&lt;p&gt;netfilter是在linux内核中的一个软件框架，用于管理网络数据包。有：网络地址转换、数据包修改、数据包过滤、防火墙等功能。&lt;/p&gt;
&lt;p&gt;我们可以使用用户空间中的iptables、nftables、ebtables和arptables等软件来控制netfilter，进而管理通过本系统的数据包。&lt;/p&gt;
&lt;h2 id=&#34;3-基本概念&#34;&gt;3. 基本概念&lt;/h2&gt;
&lt;p&gt;iptables根据规则来对数据包进行管理，一条规则包含：动作、源地址、目的地址、协议等信息。&lt;/p&gt;
&lt;p&gt;协议可以查看&lt;code&gt;/etc/protocols/&lt;/code&gt;中定义的协议类型，可使用名字(不区分大小写)、对应编号。缺省值为0，代表tcp、udp、icmp而不是定义的所有协议类型。&lt;/p&gt;
&lt;h3 id=&#34;31-五链&#34;&gt;3.1. 五链&lt;/h3&gt;
&lt;p&gt;&lt;img src=&#34;https://blog.zooter.com.cn/posts/iptables%E7%AE%80%E4%BB%8B/6b25093691631632e406caa95efc2073.png&#34;
	width=&#34;879&#34;
	height=&#34;503&#34;
	srcset=&#34;https://blog.zooter.com.cn/posts/iptables%E7%AE%80%E4%BB%8B/6b25093691631632e406caa95efc2073_hub6a8372be2ec3ed88d1c9e177b3a208f_17238_480x0_resize_box_3.png 480w, https://blog.zooter.com.cn/posts/iptables%E7%AE%80%E4%BB%8B/6b25093691631632e406caa95efc2073_hub6a8372be2ec3ed88d1c9e177b3a208f_17238_1024x0_resize_box_3.png 1024w&#34;
	loading=&#34;lazy&#34;
	
		alt=&#34;五链&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;174&#34;
		data-flex-basis=&#34;419px&#34;
	
&gt;
五链就是指图中的：prerouting、input、forward、postrouting、output五种数据包动作。
例如：&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;到本机某进程的数据包：prerouting、input&lt;/li&gt;
&lt;li&gt;进过本机转发的数据包：prerouting、forward、postrouting&lt;/li&gt;
&lt;li&gt;本机发出的数据包：output、postrouting&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id=&#34;32-四表&#34;&gt;3.2. 四表&lt;/h3&gt;
&lt;p&gt;iptables把功能相似的规则放在同一张表中，默认为我们创建了四张表：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;filter：过滤数据包。内核模块：iptables_filter&lt;/li&gt;
&lt;li&gt;nat：网络地址转换。内核模块：iptable_nat&lt;/li&gt;
&lt;li&gt;mangle：拆解、修改、重新发送数据包。内核模块：iptable_mangle&lt;/li&gt;
&lt;li&gt;raw：决定数据包是否被状态跟踪机制处理。内核模块：iptable_raw&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;33-链和表的关系&#34;&gt;3.3. 链和表的关系&lt;/h3&gt;
&lt;p&gt;不同表能作用的链的关系如表：&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;四表/五链&lt;/th&gt;
&lt;th&gt;PREROUTING&lt;/th&gt;
&lt;th&gt;INPUT&lt;/th&gt;
&lt;th&gt;FORWARD&lt;/th&gt;
&lt;th&gt;OUTPUT&lt;/th&gt;
&lt;th&gt;POSTROUTING&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;filter&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;√&lt;/td&gt;
&lt;td&gt;√&lt;/td&gt;
&lt;td&gt;√&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;nat&lt;/td&gt;
&lt;td&gt;√&lt;/td&gt;
&lt;td&gt;√(centos7)&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;√&lt;/td&gt;
&lt;td&gt;√&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;mangle&lt;/td&gt;
&lt;td&gt;√&lt;/td&gt;
&lt;td&gt;√&lt;/td&gt;
&lt;td&gt;√&lt;/td&gt;
&lt;td&gt;√&lt;/td&gt;
&lt;td&gt;√&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;raw&lt;/td&gt;
&lt;td&gt;√&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;√&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;表的优先级关系：raw &amp;gt; mangle &amp;gt; nat &amp;gt; filter，raw的最高。&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://blog.zooter.com.cn/posts/iptables%E7%AE%80%E4%BB%8B/df690840d9438f00db495afccc570234.png&#34;
	width=&#34;1012&#34;
	height=&#34;533&#34;
	srcset=&#34;https://blog.zooter.com.cn/posts/iptables%E7%AE%80%E4%BB%8B/df690840d9438f00db495afccc570234_huc78921f7b3b17e0505b0270b22a9b248_54598_480x0_resize_box_3.png 480w, https://blog.zooter.com.cn/posts/iptables%E7%AE%80%E4%BB%8B/df690840d9438f00db495afccc570234_huc78921f7b3b17e0505b0270b22a9b248_54598_1024x0_resize_box_3.png 1024w&#34;
	loading=&#34;lazy&#34;
	
		alt=&#34;链和表的关系&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;189&#34;
		data-flex-basis=&#34;455px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://blog.zooter.com.cn/posts/iptables%E7%AE%80%E4%BB%8B/38580d12214b7e58866fe1fff9621e13.png&#34;
	width=&#34;647&#34;
	height=&#34;1100&#34;
	srcset=&#34;https://blog.zooter.com.cn/posts/iptables%E7%AE%80%E4%BB%8B/38580d12214b7e58866fe1fff9621e13_hu80f9236f07e59e3703beda899701e300_250958_480x0_resize_box_3.png 480w, https://blog.zooter.com.cn/posts/iptables%E7%AE%80%E4%BB%8B/38580d12214b7e58866fe1fff9621e13_hu80f9236f07e59e3703beda899701e300_250958_1024x0_resize_box_3.png 1024w&#34;
	loading=&#34;lazy&#34;
	
		alt=&#34;数据包处理流程&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;58&#34;
		data-flex-basis=&#34;141px&#34;
	
&gt;&lt;/p&gt;
&lt;h2 id=&#34;4-规则&#34;&gt;4. 规则&lt;/h2&gt;
&lt;p&gt;规则是根据指定的匹配条件来尝试匹配每个流经此处的报文，一旦匹配成功，则由规则后面指定的处理动作进行处理。&lt;/p&gt;
&lt;h3 id=&#34;41-匹配条件&#34;&gt;4.1. 匹配条件&lt;/h3&gt;
&lt;p&gt;匹配条件分为基本匹配条件与扩展匹配条件：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;基本匹配条件：
源地址Source IP，目标地址 Destination IP
上述内容都可以作为基本匹配条件。&lt;/li&gt;
&lt;li&gt;扩展匹配条件：
除了上述的条件可以用于匹配，还有很多其他的条件可以用于匹配，这些条件泛称为扩展条件，这些扩展条件其实也是netfilter中的一部分，只是以模块的形式存在，如果想要使用这些条件，则需要依赖对应的扩展模块。&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;下面仅列出常用的简单匹配规则。&lt;/p&gt;
&lt;h4 id=&#34;411-ip地址匹配&#34;&gt;4.1.1 IP地址匹配&lt;/h4&gt;
&lt;p&gt;我们可以使用&lt;code&gt;-s&lt;/code&gt;和&lt;code&gt;-d&lt;/code&gt;指定匹配源IP和目的IP，还可以使用&lt;code&gt;!&lt;/code&gt;来表示取反，多个规则时使用&lt;code&gt;,&lt;/code&gt;号隔开。例如：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-shell&#34; data-lang=&#34;shell&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;# 单个匹配&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;iptables -I INPUT -s 1.1.1.2 -j DROP
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;# 多个匹配&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;iptables -I INPUT -s 1.1.1.3,1.1.1.4 -j DROP
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;# 网段匹配&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;iptables -I INPUT -s 1.1.1.5/23 -j DROP
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;# 取反匹配&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;iptables -I INPUT ! -s 1.1.1.6 -j ACCEPT
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;# 源和目的IP匹配&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;iptables -I INPUT -s 1.1.1.7 -d 1.1.1.8 -j DROP
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h4 id=&#34;412-协议匹配&#34;&gt;4.1.2 协议匹配&lt;/h4&gt;
&lt;p&gt;我们可以使用&lt;code&gt;-p&lt;/code&gt;指定匹配的协议，可使用协议名称(不区分大小写)，或对应编号。支持协议可查看&lt;code&gt;/etc/protocols&lt;/code&gt;中的内容，也可以查看相关&lt;a class=&#34;link&#34; href=&#34;https://www.iana.org/assignments/protocol-numbers/protocol-numbers.xhtml&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;RFC文档定义的协议和对应编号&lt;/a&gt;。&lt;/p&gt;
&lt;p&gt;在指定IP地址匹配的同时可指定具体协议，例如：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-shell&#34; data-lang=&#34;shell&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;# 不响应指定源IP的ping数据包&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;iptables -I INPUT -s 1.1.1.2 -p icmp -j DROP
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h4 id=&#34;413-接口匹配&#34;&gt;4.1.3 接口匹配&lt;/h4&gt;
&lt;p&gt;我们还可以使用&lt;code&gt;-i&lt;/code&gt;和&lt;code&gt;-o&lt;/code&gt;参数根据流入和流出的接口来匹配。&lt;code&gt;-i&lt;/code&gt;匹配流入的网卡，作用于PREROUTING、INPUT、FORWARD；&lt;code&gt;-o&lt;/code&gt;匹配流出的网卡，作用于FORWARD、OUTPUT、POSTROUTING。&lt;/p&gt;
&lt;h4 id=&#34;414-端口匹配&#34;&gt;4.1.4 端口匹配&lt;/h4&gt;
&lt;p&gt;端口匹配属于扩展匹配条件，需要依赖扩展模块。&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;单端口匹配&lt;/p&gt;
&lt;p&gt;单端口匹配依赖tcp扩展模块，使用&lt;code&gt;-m tcp&lt;/code&gt;指定扩展模块，然后使用&lt;code&gt;--dport&lt;/code&gt;指定目的端口；&lt;code&gt;--sport&lt;/code&gt;指定源端口。以&lt;code&gt;22:55&lt;/code&gt;的形式指定端口范围。例如：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-shell&#34; data-lang=&#34;shell&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;# 丢弃来自1.1.1.2的tcp协议且目的端口是22的数据包&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;iptables -I INPUT -s 1.1.1.2 -p tcp -m tcp --dport &lt;span class=&#34;m&#34;&gt;22&lt;/span&gt; -j DROP
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;多端口匹配&lt;/p&gt;
&lt;p&gt;多端口匹配适用于同时指定多个离散的端口，需要依赖multiport扩展模块。例如：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-shell&#34; data-lang=&#34;shell&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;iptables -I INPUT -s 1.1.1.2 -p tcp -m multiport --dports 22,36,80 -j DROP
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id=&#34;42-处理动作&#34;&gt;4.2. 处理动作&lt;/h3&gt;
&lt;p&gt;处理动作在iptables中被称为target（这样说并不准确，我们暂且这样称呼），动作也可以分为基本动作和扩展动作。
此处列出一些常用的动作，之后的文章会对它们进行详细的示例与总结：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;ACCEPT：允许数据包通过。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;DROP：直接丢弃数据包，不给任何回应信息，这时候客户端会感觉自己的请求泥牛入海了，过了超时时间才会有反应。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;REJECT：拒绝数据包通过，必要时会给数据发送端一个响应的信息，客户端刚请求就会收到拒绝的信息。&lt;/p&gt;
&lt;p&gt;可附加&lt;code&gt;–reject-with&lt;/code&gt;参数，指定拒绝对方时的响应类型，缺省为icmp-port-unreachable。可指定的类型有：icmp-net-unreachable、icmp-host-unreachable、icmp-port-unreachable、icmp-proto-unreachable、icmp-net-prohibited、icmp-host-pro-hibited、icmp-admin-prohibited。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;SNAT：源地址转换，解决内网用户用同一个公网地址上网的问题。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;MASQUERADE：是SNAT的一种特殊形式，适用于动态的、临时会变的ip上。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;DNAT：目标地址转换。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;REDIRECT：在本机做端口映射。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;LOG：在/var/log/messages文件中记录日志信息，然后将数据包传递给下一条规则，也就是说除了记录以外不对数据包做任何其他操作，仍然让下一条规则去匹配。&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;补充一下DROP和REJECT的区别。DROP是直接把匹配到的报文丢弃，REJECT除了把报文丢弃还会给该报文中的源IP发一个ICMP报文说明目的不可达(直接回复不可达, 更强硬)。前者报文发送方只能等超时，而后者发送方因为收到了ICMP不可达所以马上就给出了提示。&lt;/p&gt;
&lt;h2 id=&#34;5-命令使用&#34;&gt;5. 命令使用&lt;/h2&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;28
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;29
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;30
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;31
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;32
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;33
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;34
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;35
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;36
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;37
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;38
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;39
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;40
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;41
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;42
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;43
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;44
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;45
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;46
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;47
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;48
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;49
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;50
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;51
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;52
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;53
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;54
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;55
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;56
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;57
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;58
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;59
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;60
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;61
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;62
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;63
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;64
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;65
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;66
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;67
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;68
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-shell&#34; data-lang=&#34;shell&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;~ &lt;span class=&#34;c1&#34;&gt;# iptables -h&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;iptables v1.4.21
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;Usage: iptables -&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;ACD&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; chain rule-specification &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;options&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;       iptables -I chain &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;rulenum&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; rule-specification &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;options&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;       iptables -R chain rulenum rule-specification &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;options&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;       iptables -D chain rulenum &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;options&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;       iptables -&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;LS&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;chain &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;rulenum&lt;span class=&#34;o&#34;&gt;]]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;options&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;       iptables -&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;FZ&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;chain&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;options&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;       iptables -&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;NX&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; chain
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;       iptables -E old-chain-name new-chain-name
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;       iptables -P chain target &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;options&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;       iptables -h &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;print this &lt;span class=&#34;nb&#34;&gt;help&lt;/span&gt; information&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;Commands:
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;Either long or short options are allowed.
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  --append  -A chain Append to chain
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  --check   -C chain  Check &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; the existence of a rule
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  --delete  -D chain  Delete matching rule from chain
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  --delete  -D chain rulenum
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        Delete rule rulenum &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;1&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; first&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; from chain
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  --insert  -I chain &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;rulenum&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        Insert in chain as rulenum &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;default &lt;span class=&#34;nv&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;first&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  --replace -R chain rulenum
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        Replace rule rulenum &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;1&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; first&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; in chain
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  --list    -L &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;chain &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;rulenum&lt;span class=&#34;o&#34;&gt;]]&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        List the rules in a chain or all chains
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  --list-rules -S &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;chain &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;rulenum&lt;span class=&#34;o&#34;&gt;]]&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        Print the rules in a chain or all chains
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  --flush   -F &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;chain&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;    Delete all rules in  chain or all chains
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  --zero    -Z &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;chain &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;rulenum&lt;span class=&#34;o&#34;&gt;]]&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        Zero counters in chain or all chains
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  --new     -N chain    Create a new user-defined chain
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  --delete-chain
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;            -X &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;chain&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;    Delete a user-defined chain
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  --policy  -P chain target
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        Change policy on chain to target
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  --rename-chain
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;            -E old-chain new-chain
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        Change chain name, &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;moving any references&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;Options:
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    --ipv4  -4    Nothing &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;line is ignored by ip6tables-restore&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    --ipv6  -6    Error &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;line is ignored by iptables-restore&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;!&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; --protocol  -p proto  protocol: by number or name, eg. &lt;span class=&#34;sb&#34;&gt;`&lt;/span&gt;tcp&lt;span class=&#34;s1&#34;&gt;&amp;#39;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s1&#34;&gt;[!] --source  -s address[/mask][...]
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s1&#34;&gt;        source specification
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s1&#34;&gt;[!] --destination -d address[/mask][...]
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s1&#34;&gt;        destination specification
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s1&#34;&gt;[!] --in-interface -i input name[+]
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s1&#34;&gt;        network interface name ([+] for wildcard)
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s1&#34;&gt; --jump -j target
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s1&#34;&gt;        target for rule (may load target extension)
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s1&#34;&gt;  --goto      -g chain
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s1&#34;&gt;                              jump to chain with no return
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s1&#34;&gt;  --match -m match
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s1&#34;&gt;        extended match (may load extension)
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s1&#34;&gt;  --numeric -n    numeric output of addresses and ports
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s1&#34;&gt;[!] --out-interface -o output name[+]
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s1&#34;&gt;        network interface name ([+] for wildcard)
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s1&#34;&gt;  --table -t table  table to manipulate (default: `filter&amp;#39;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  --verbose -v    verbose mode
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  --wait  -w    &lt;span class=&#34;nb&#34;&gt;wait&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; the xtables lock
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  --line-numbers    print line numbers when listing
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  --exact -x    expand numbers &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;display exact values&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;!&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; --fragment  -f    match second or further fragments only
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  --modprobe&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;lt;command&amp;gt;    try to insert modules using this &lt;span class=&#34;nb&#34;&gt;command&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  --set-counters PKTS BYTES &lt;span class=&#34;nb&#34;&gt;set&lt;/span&gt; the counter during insert/append
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;!&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; --version -V    print package version.
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h2 id=&#34;6-filter表实践&#34;&gt;6. filter表实践&lt;/h2&gt;
&lt;p&gt;filter是负责数据包过滤的表，是我们最常用的表。&lt;/p&gt;
&lt;p&gt;首先查看filter表中原有的规则：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-shell&#34; data-lang=&#34;shell&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;~ &lt;span class=&#34;c1&#34;&gt;# iptables -t filter -nvL --line&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;Chain INPUT &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;policy ACCEPT &lt;span class=&#34;m&#34;&gt;6214&lt;/span&gt; packets, 569K bytes&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;num   pkts bytes target     prot opt in     out     &lt;span class=&#34;nb&#34;&gt;source&lt;/span&gt;               destination         
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;m&#34;&gt;1&lt;/span&gt;     &lt;span class=&#34;m&#34;&gt;9889&lt;/span&gt; 1160K ACCEPT     all  --  eth0.1 *       0.0.0.0/0            0.0.0.0/0            state RELATED,ESTABLISHED
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;m&#34;&gt;2&lt;/span&gt;        &lt;span class=&#34;m&#34;&gt;5&lt;/span&gt;   &lt;span class=&#34;m&#34;&gt;320&lt;/span&gt; DROP       icmp --  eth0.1 *       0.0.0.0/0            0.0.0.0/0            icmptype &lt;span class=&#34;m&#34;&gt;8&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;m&#34;&gt;3&lt;/span&gt;     &lt;span class=&#34;m&#34;&gt;7007&lt;/span&gt;  630K access_ctrl  all  --  *      *       0.0.0.0/0            0.0.0.0/0           
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;m&#34;&gt;4&lt;/span&gt;      &lt;span class=&#34;m&#34;&gt;522&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;34807&lt;/span&gt; DROP       all  --  eth0.1 *       0.0.0.0/0            0.0.0.0/0           
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;Chain FORWARD &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;policy ACCEPT &lt;span class=&#34;m&#34;&gt;26932&lt;/span&gt; packets, 6125K bytes&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;num   pkts bytes target     prot opt in     out     &lt;span class=&#34;nb&#34;&gt;source&lt;/span&gt;               destination         
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;Chain OUTPUT &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;policy ACCEPT &lt;span class=&#34;m&#34;&gt;32373&lt;/span&gt; packets, 8525K bytes&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;num   pkts bytes target     prot opt in     out     &lt;span class=&#34;nb&#34;&gt;source&lt;/span&gt;               destination         
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;m&#34;&gt;1&lt;/span&gt;     &lt;span class=&#34;m&#34;&gt;1354&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;83951&lt;/span&gt; dns_drop   udp  --  *      *       0.0.0.0/0            0.0.0.0/0            udp dpt:53 state NEW
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;Chain access_ctrl &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; references&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;num   pkts bytes target     prot opt in     out     &lt;span class=&#34;nb&#34;&gt;source&lt;/span&gt;               destination         
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;m&#34;&gt;1&lt;/span&gt;        &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt;     &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt; ACCEPT     icmp --  eth0.1 *       0.0.0.0/0            0.0.0.0/0           
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;m&#34;&gt;2&lt;/span&gt;        &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt;     &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt; ACCEPT     tcp  --  eth0.1 *       0.0.0.0/0            0.0.0.0/0            tcp dpt:1723
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;m&#34;&gt;3&lt;/span&gt;        &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt;     &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt; ACCEPT     udp  --  eth0.1 *       0.0.0.0/0            0.0.0.0/0            udp dpt:1701
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;m&#34;&gt;4&lt;/span&gt;        &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt;     &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt; ACCEPT     &lt;span class=&#34;m&#34;&gt;41&lt;/span&gt;   --  eth0.1 *       0.0.0.0/0            0.0.0.0/0           
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;Chain dns_drop &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; references&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;num   pkts bytes target     prot opt in     out     &lt;span class=&#34;nb&#34;&gt;source&lt;/span&gt;               destination         
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;添加不响应测试主机ping的规则：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-shell&#34; data-lang=&#34;shell&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;~ &lt;span class=&#34;c1&#34;&gt;# iptables -I INPUT -s 192.168.1.141 -p icmp -j DROP&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;测试：&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://blog.zooter.com.cn/posts/iptables%E7%AE%80%E4%BB%8B/c5908e4ee35403100b9e0bfd80b0acf6.png&#34;
	width=&#34;473&#34;
	height=&#34;141&#34;
	srcset=&#34;https://blog.zooter.com.cn/posts/iptables%E7%AE%80%E4%BB%8B/c5908e4ee35403100b9e0bfd80b0acf6_hu6861c6cca334584ae8563dee1aaafc42_3425_480x0_resize_box_3.png 480w, https://blog.zooter.com.cn/posts/iptables%E7%AE%80%E4%BB%8B/c5908e4ee35403100b9e0bfd80b0acf6_hu6861c6cca334584ae8563dee1aaafc42_3425_1024x0_resize_box_3.png 1024w&#34;
	loading=&#34;lazy&#34;
	
		alt=&#34;添加规则后测试&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;335&#34;
		data-flex-basis=&#34;805px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;删除规则：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;9
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-shell&#34; data-lang=&#34;shell&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;~ &lt;span class=&#34;c1&#34;&gt;# iptables -L INPUT --line&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;Chain INPUT &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;policy ACCEPT&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;num  target     prot opt &lt;span class=&#34;nb&#34;&gt;source&lt;/span&gt;               destination         
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;m&#34;&gt;1&lt;/span&gt;    DROP       icmp --  192.168.1.141        anywhere            
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;m&#34;&gt;2&lt;/span&gt;    ACCEPT     all  --  anywhere             anywhere             state RELATED,ESTABLISHED
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;m&#34;&gt;3&lt;/span&gt;    DROP       icmp --  anywhere             anywhere             icmp echo-request
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;m&#34;&gt;4&lt;/span&gt;    access_ctrl  all  --  anywhere             anywhere            
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;m&#34;&gt;5&lt;/span&gt;    DROP       all  --  anywhere             anywhere            
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;~ &lt;span class=&#34;c1&#34;&gt;# iptables -D INPUT 1&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;再次测试：&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://blog.zooter.com.cn/posts/iptables%E7%AE%80%E4%BB%8B/e1eb5afdea68acf1794cf4eb5bd1e3e6.png&#34;
	width=&#34;454&#34;
	height=&#34;174&#34;
	srcset=&#34;https://blog.zooter.com.cn/posts/iptables%E7%AE%80%E4%BB%8B/e1eb5afdea68acf1794cf4eb5bd1e3e6_hu0df0ee8775179dadafb48a4f18f8672f_6979_480x0_resize_box_3.png 480w, https://blog.zooter.com.cn/posts/iptables%E7%AE%80%E4%BB%8B/e1eb5afdea68acf1794cf4eb5bd1e3e6_hu0df0ee8775179dadafb48a4f18f8672f_6979_1024x0_resize_box_3.png 1024w&#34;
	loading=&#34;lazy&#34;
	
		alt=&#34;删除规则后测试&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;260&#34;
		data-flex-basis=&#34;626px&#34;
	
&gt;&lt;/p&gt;
</description>
        </item>
        <item>
        <title>IPv6LAN侧动态寻址</title>
        <link>https://blog.zooter.com.cn/posts/ipv6lan%E4%BE%A7%E5%8A%A8%E6%80%81%E5%AF%BB%E5%9D%80/</link>
        <pubDate>Sun, 13 Mar 2022 18:44:42 -0700</pubDate>
        
        <guid>https://blog.zooter.com.cn/posts/ipv6lan%E4%BE%A7%E5%8A%A8%E6%80%81%E5%AF%BB%E5%9D%80/</guid>
        <description>&lt;h1 id=&#34;ipv6动态寻址&#34;&gt;IPv6动态寻址&lt;/h1&gt;
&lt;h2 id=&#34;1-简介&#34;&gt;1. 简介&lt;/h2&gt;
&lt;p&gt;IPv6动态寻址有三种方式：无状态地址自动配置(SLAAC)、无状态DHCPv6、有状态DHCPv6。&lt;/p&gt;
&lt;p&gt;其中有无状态是指IP地址能否被统一管理，例如：有状态DHCPv6指IP地址由DHCPv6服务器分配，网络管理员能通过DHCPv6服务对IP地址进行统一管理。&lt;/p&gt;
&lt;h2 id=&#34;2-rars消息&#34;&gt;2. RA/RS消息&lt;/h2&gt;
&lt;p&gt;RA/RS分别是路由通告消息和路由请求消息的缩写，这两个消息类型是ICMPv6邻居发现协议定义的。&lt;/p&gt;
&lt;h3 id=&#34;21-ra路由通告消息&#34;&gt;2.1 RA路由通告消息&lt;/h3&gt;
&lt;p&gt;RA消息由IPv6路由器向多播地址&lt;code&gt;ff02::1&lt;/code&gt;发送，目的是宣布自身存在以及向消息发送接口所连链路有关的IPv6地址信息和配置参数，如：链路的IPv6前缀、前缀长度、默认网关的地址、链路最大传输单元(MTU)。&lt;/p&gt;
&lt;p&gt;通常的IPv6路由器会定时向链路发送路由通告消息，如果收到设备发送的RS消息，也会立即发送RA消息。&lt;/p&gt;
&lt;h4 id=&#34;211-aom标志位&#34;&gt;2.1.1 A、O、M标志位&lt;/h4&gt;
&lt;p&gt;RA消息中可携带三种标志位，向IPv6设备建议如何创建或获取地址。&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;A标志位（地址自动配置标记）&lt;/p&gt;
&lt;p&gt;该标志位出现在RA消息的Option中的Prefix Information里。当该标志位打开(置1)时，表示建议主机采用SLAAC方式来创建地址，采用RA消息中的前缀加上接口ID生成地址。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;O标志位（其他配置标记）&lt;/p&gt;
&lt;p&gt;该标志位出现在RA消息主体里。当该标志位打开(置1)时，表示建议主机采用SLAAC方式来创建地址，通过DHCPv6服务器获取除地址以外的其他地址信息，如：DNS服务器的IP地址和域名。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;M标志位（管理地址配置标记）&lt;/p&gt;
&lt;p&gt;该标志位出现在RA消息主体里。当该标志位打开(置1)时，表示建议主机从DHCPv6服务器获取地址及所有其他地址信息，只从RA消息中获取IPv6网关地址。&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;M&lt;/th&gt;
&lt;th&gt;O&lt;/th&gt;
&lt;th&gt;A&lt;/th&gt;
&lt;th&gt;IP地址&lt;/th&gt;
&lt;th&gt;其他配置&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;0&lt;/td&gt;
&lt;td&gt;0&lt;/td&gt;
&lt;td&gt;0&lt;/td&gt;
&lt;td&gt;静态设置&lt;/td&gt;
&lt;td&gt;手工配置&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;0&lt;/td&gt;
&lt;td&gt;0&lt;/td&gt;
&lt;td&gt;1&lt;/td&gt;
&lt;td&gt;前缀由 RA 指定，自动生成&lt;/td&gt;
&lt;td&gt;手工配置&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;0&lt;/td&gt;
&lt;td&gt;1&lt;/td&gt;
&lt;td&gt;0&lt;/td&gt;
&lt;td&gt;静态设置&lt;/td&gt;
&lt;td&gt;DHCPv6&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;0&lt;/td&gt;
&lt;td&gt;1&lt;/td&gt;
&lt;td&gt;1&lt;/td&gt;
&lt;td&gt;前缀由 RA 指定，自动生成&lt;/td&gt;
&lt;td&gt;DHCPv6&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;1&lt;/td&gt;
&lt;td&gt;0&lt;/td&gt;
&lt;td&gt;0&lt;/td&gt;
&lt;td&gt;有状态 DHCPv6&lt;/td&gt;
&lt;td&gt;DHCPv6&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;1&lt;/td&gt;
&lt;td&gt;0&lt;/td&gt;
&lt;td&gt;1&lt;/td&gt;
&lt;td&gt;有状态 DHCPv6 和/或 自动生成&lt;/td&gt;
&lt;td&gt;DHCPv6&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;1&lt;/td&gt;
&lt;td&gt;1&lt;/td&gt;
&lt;td&gt;0&lt;/td&gt;
&lt;td&gt;有状态 DHCPv6&lt;/td&gt;
&lt;td&gt;DHCPv6&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;1&lt;/td&gt;
&lt;td&gt;1&lt;/td&gt;
&lt;td&gt;1&lt;/td&gt;
&lt;td&gt;有状态 DHCPv6 和/或 自动生成&lt;/td&gt;
&lt;td&gt;DHCPv6&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;22-rs路由恳求消息&#34;&gt;2.2 RS路由恳求消息&lt;/h3&gt;
&lt;p&gt;RS消息由IPv6设备向多播地址&lt;code&gt;ff02::2&lt;/code&gt;发送，源地址是设备的本地链路地址(LLA)或IPv6未指定地址(::)，目的是向IPv6路由器请求链路地址相关的信息。&lt;/p&gt;
&lt;h2 id=&#34;3-无状态地址自动配置slaac&#34;&gt;3. 无状态地址自动配置(SLAAC)&lt;/h2&gt;
&lt;p&gt;以下是SLAAC配置地址的流程：&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;客户端接口启动成功后，向&lt;code&gt;ff02::2&lt;/code&gt;发送RS消息。&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://blog.zooter.com.cn/posts/ipv6lan%E4%BE%A7%E5%8A%A8%E6%80%81%E5%AF%BB%E5%9D%80/a5a6a5ca9cade2a6f35faee3e1a6f58c.png&#34;
	width=&#34;992&#34;
	height=&#34;350&#34;
	srcset=&#34;https://blog.zooter.com.cn/posts/ipv6lan%E4%BE%A7%E5%8A%A8%E6%80%81%E5%AF%BB%E5%9D%80/a5a6a5ca9cade2a6f35faee3e1a6f58c_hu26f54fe95ce16dbd63901882cc0bf7aa_27359_480x0_resize_box_3.png 480w, https://blog.zooter.com.cn/posts/ipv6lan%E4%BE%A7%E5%8A%A8%E6%80%81%E5%AF%BB%E5%9D%80/a5a6a5ca9cade2a6f35faee3e1a6f58c_hu26f54fe95ce16dbd63901882cc0bf7aa_27359_1024x0_resize_box_3.png 1024w&#34;
	loading=&#34;lazy&#34;
	
		alt=&#34;SLAAC-RS消息&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;283&#34;
		data-flex-basis=&#34;680px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;源地址为客户端的本地链路地址(LLA)，目的地址是代表所有IPv6路由器的多播地址。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;IPv6路由器接收到RS消息后，立即向&lt;code&gt;ff02::1&lt;/code&gt;或客户端LLA发送RA消息。&lt;/p&gt;
&lt;p&gt;因为采用SLAAC自动生成地址，所以RA消息中的A标志位置1，O和M标志位置0。&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://blog.zooter.com.cn/posts/ipv6lan%E4%BE%A7%E5%8A%A8%E6%80%81%E5%AF%BB%E5%9D%80/2be01e8055cd0a13abc0bef4a00854e2.png&#34;
	width=&#34;992&#34;
	height=&#34;947&#34;
	srcset=&#34;https://blog.zooter.com.cn/posts/ipv6lan%E4%BE%A7%E5%8A%A8%E6%80%81%E5%AF%BB%E5%9D%80/2be01e8055cd0a13abc0bef4a00854e2_hu0af857552c873684d0c99238472d2b6a_72747_480x0_resize_box_3.png 480w, https://blog.zooter.com.cn/posts/ipv6lan%E4%BE%A7%E5%8A%A8%E6%80%81%E5%AF%BB%E5%9D%80/2be01e8055cd0a13abc0bef4a00854e2_hu0af857552c873684d0c99238472d2b6a_72747_1024x0_resize_box_3.png 1024w&#34;
	loading=&#34;lazy&#34;
	
		alt=&#34;SLAAC-RA消息&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;104&#34;
		data-flex-basis=&#34;251px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;源地址为IPv6路由器的本地链路地址，目的地址是客户端的本地链路地址，M标志位为0，O标志位为1（M20-8G和AC5客供软件在设置为SLAAC模式后，RA消息中O标志位都置为1，暂不清楚原因）。&lt;/p&gt;
&lt;p&gt;在选项中可以看到：A标志位为1，表示建议客户端自动生成地址；当前链路的MTU位1500；DNS服务器为&lt;code&gt;fc00::ac6:b3ff:feb9:689d&lt;/code&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;客户端使用RA报文中的前缀和接口ID生成IP地址。&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://blog.zooter.com.cn/posts/ipv6lan%E4%BE%A7%E5%8A%A8%E6%80%81%E5%AF%BB%E5%9D%80/579ecbd1919d2e8e225aa1c40984009d.png&#34;
	width=&#34;411&#34;
	height=&#34;546&#34;
	srcset=&#34;https://blog.zooter.com.cn/posts/ipv6lan%E4%BE%A7%E5%8A%A8%E6%80%81%E5%AF%BB%E5%9D%80/579ecbd1919d2e8e225aa1c40984009d_huc586770b73f51e24d9657a54ecca7afc_30432_480x0_resize_box_3.png 480w, https://blog.zooter.com.cn/posts/ipv6lan%E4%BE%A7%E5%8A%A8%E6%80%81%E5%AF%BB%E5%9D%80/579ecbd1919d2e8e225aa1c40984009d_huc586770b73f51e24d9657a54ecca7afc_30432_1024x0_resize_box_3.png 1024w&#34;
	loading=&#34;lazy&#34;
	
		alt=&#34;SLAAC-网卡信息&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;75&#34;
		data-flex-basis=&#34;180px&#34;
	
&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&#34;4-无状态dhcpv6&#34;&gt;4. 无状态DHCPv6&lt;/h2&gt;
&lt;p&gt;无状态DHCPv6的地址配置过程与SLAAC类似，但增加了与DHCP服务器交互的过程。以下是无状态DHCPv6配置地址的流程：&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;客户端接口启动成功后，向&lt;code&gt;ff02::2&lt;/code&gt;发送RS消息。&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://blog.zooter.com.cn/posts/ipv6lan%E4%BE%A7%E5%8A%A8%E6%80%81%E5%AF%BB%E5%9D%80/a5a6a5ca9cade2a6f35faee3e1a6f58c.png&#34;
	width=&#34;992&#34;
	height=&#34;350&#34;
	srcset=&#34;https://blog.zooter.com.cn/posts/ipv6lan%E4%BE%A7%E5%8A%A8%E6%80%81%E5%AF%BB%E5%9D%80/a5a6a5ca9cade2a6f35faee3e1a6f58c_hu26f54fe95ce16dbd63901882cc0bf7aa_27359_480x0_resize_box_3.png 480w, https://blog.zooter.com.cn/posts/ipv6lan%E4%BE%A7%E5%8A%A8%E6%80%81%E5%AF%BB%E5%9D%80/a5a6a5ca9cade2a6f35faee3e1a6f58c_hu26f54fe95ce16dbd63901882cc0bf7aa_27359_1024x0_resize_box_3.png 1024w&#34;
	loading=&#34;lazy&#34;
	
		alt=&#34;无状态DHCPv6-RS报文&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;283&#34;
		data-flex-basis=&#34;680px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;源地址为客户端的本地链路地址(LLA)，目的地址是代表所有IPv6路由器的多播地址。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;IPv6路由器接收到RS消息后，立即向&lt;code&gt;ff02::1&lt;/code&gt;或客户端LLA发送RA消息。&lt;/p&gt;
&lt;p&gt;因为采用SLAAC自动生成地址，所以RA消息中的A和O标志位置1，M标志位置0。&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://blog.zooter.com.cn/posts/ipv6lan%E4%BE%A7%E5%8A%A8%E6%80%81%E5%AF%BB%E5%9D%80/0fd6a51e063c193829bc75fe6bc923ea.png&#34;
	width=&#34;991&#34;
	height=&#34;728&#34;
	srcset=&#34;https://blog.zooter.com.cn/posts/ipv6lan%E4%BE%A7%E5%8A%A8%E6%80%81%E5%AF%BB%E5%9D%80/0fd6a51e063c193829bc75fe6bc923ea_hu9412e8484b0f58927fd009f74abeaab1_60150_480x0_resize_box_3.png 480w, https://blog.zooter.com.cn/posts/ipv6lan%E4%BE%A7%E5%8A%A8%E6%80%81%E5%AF%BB%E5%9D%80/0fd6a51e063c193829bc75fe6bc923ea_hu9412e8484b0f58927fd009f74abeaab1_60150_1024x0_resize_box_3.png 1024w&#34;
	loading=&#34;lazy&#34;
	
		alt=&#34;无状态DHCPv6-RA报文&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;136&#34;
		data-flex-basis=&#34;326px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;源地址为IPv6路由器的本地链路地址，目的地址是代表所有IPv6客户端的多播地址，M标志位为0，O标志位为1。&lt;/p&gt;
&lt;p&gt;在选项中可以看到：A标志位为1，表示建议客户端自动生成地址。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;客户端使用RA报文中的前缀和接口ID生成IP地址。&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://blog.zooter.com.cn/posts/ipv6lan%E4%BE%A7%E5%8A%A8%E6%80%81%E5%AF%BB%E5%9D%80/483ccb9bd9fb0062c509bd42d52a40d8.png&#34;
	width=&#34;403&#34;
	height=&#34;457&#34;
	srcset=&#34;https://blog.zooter.com.cn/posts/ipv6lan%E4%BE%A7%E5%8A%A8%E6%80%81%E5%AF%BB%E5%9D%80/483ccb9bd9fb0062c509bd42d52a40d8_hu575ad9a516d35952f6d6bce167b4710b_25928_480x0_resize_box_3.png 480w, https://blog.zooter.com.cn/posts/ipv6lan%E4%BE%A7%E5%8A%A8%E6%80%81%E5%AF%BB%E5%9D%80/483ccb9bd9fb0062c509bd42d52a40d8_hu575ad9a516d35952f6d6bce167b4710b_25928_1024x0_resize_box_3.png 1024w&#34;
	loading=&#34;lazy&#34;
	
		alt=&#34;无状态DHCPv6-网卡信息&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;88&#34;
		data-flex-basis=&#34;211px&#34;
	
&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;客户端发送DHCPv6恳求消息寻找DHCPv6服务器。&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://blog.zooter.com.cn/posts/ipv6lan%E4%BE%A7%E5%8A%A8%E6%80%81%E5%AF%BB%E5%9D%80/3c8cda5a02605ce905568d06d2be4aa7.png&#34;
	width=&#34;992&#34;
	height=&#34;857&#34;
	srcset=&#34;https://blog.zooter.com.cn/posts/ipv6lan%E4%BE%A7%E5%8A%A8%E6%80%81%E5%AF%BB%E5%9D%80/3c8cda5a02605ce905568d06d2be4aa7_hu0ef1e168e22ffac60aa7bd350e27dd63_64876_480x0_resize_box_3.png 480w, https://blog.zooter.com.cn/posts/ipv6lan%E4%BE%A7%E5%8A%A8%E6%80%81%E5%AF%BB%E5%9D%80/3c8cda5a02605ce905568d06d2be4aa7_hu0ef1e168e22ffac60aa7bd350e27dd63_64876_1024x0_resize_box_3.png 1024w&#34;
	loading=&#34;lazy&#34;
	
		alt=&#34;无状态DHCPv6-DHCPv6恳求消息&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;115&#34;
		data-flex-basis=&#34;277px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;源地址为客户端本地链路地址，目的地址为代表所有DHCPv6服务器和中继服务器的多播地址&lt;code&gt;ff02::1:2&lt;/code&gt;，目的是定位DHCPv6服务器。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;DHCPv6服务器回应请求，发送DHCPv6通告消息。&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://blog.zooter.com.cn/posts/ipv6lan%E4%BE%A7%E5%8A%A8%E6%80%81%E5%AF%BB%E5%9D%80/81d575439e67f78ab1104aafe627948c.png&#34;
	width=&#34;940&#34;
	height=&#34;548&#34;
	srcset=&#34;https://blog.zooter.com.cn/posts/ipv6lan%E4%BE%A7%E5%8A%A8%E6%80%81%E5%AF%BB%E5%9D%80/81d575439e67f78ab1104aafe627948c_hu4b8273fbb24dbbfa91be048bef06bc4a_44139_480x0_resize_box_3.png 480w, https://blog.zooter.com.cn/posts/ipv6lan%E4%BE%A7%E5%8A%A8%E6%80%81%E5%AF%BB%E5%9D%80/81d575439e67f78ab1104aafe627948c_hu4b8273fbb24dbbfa91be048bef06bc4a_44139_1024x0_resize_box_3.png 1024w&#34;
	loading=&#34;lazy&#34;
	
		alt=&#34;无状态DHCPv6-DHCPv6通告消息&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;171&#34;
		data-flex-basis=&#34;411px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;DHCPv6服务器发送通告消息，源地址是DHCPv6服务器本地链路地址，目的地址是客户端的本地链路地址。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;客户端发送DHCPv6信息请求消息。&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://blog.zooter.com.cn/posts/ipv6lan%E4%BE%A7%E5%8A%A8%E6%80%81%E5%AF%BB%E5%9D%80/48da0b9401daa245c0ca519e5d0b4447.png&#34;
	width=&#34;940&#34;
	height=&#34;627&#34;
	srcset=&#34;https://blog.zooter.com.cn/posts/ipv6lan%E4%BE%A7%E5%8A%A8%E6%80%81%E5%AF%BB%E5%9D%80/48da0b9401daa245c0ca519e5d0b4447_hu7e0f64de41ab31358e16aaa36d4bf30d_49120_480x0_resize_box_3.png 480w, https://blog.zooter.com.cn/posts/ipv6lan%E4%BE%A7%E5%8A%A8%E6%80%81%E5%AF%BB%E5%9D%80/48da0b9401daa245c0ca519e5d0b4447_hu7e0f64de41ab31358e16aaa36d4bf30d_49120_1024x0_resize_box_3.png 1024w&#34;
	loading=&#34;lazy&#34;
	
		alt=&#34;无状态DHCPv6-DHCPv6信息请求消息&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;149&#34;
		data-flex-basis=&#34;359px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;客户端再发送信息请求消息，请求从DHCPv6服务器获取地址参数（不是地址）。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;DHCPv6服务器回应请求，发送DHCPv6应答消息。&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://blog.zooter.com.cn/posts/ipv6lan%E4%BE%A7%E5%8A%A8%E6%80%81%E5%AF%BB%E5%9D%80/e72d788e18723fc6a0d48ecc77185e97.png&#34;
	width=&#34;941&#34;
	height=&#34;635&#34;
	srcset=&#34;https://blog.zooter.com.cn/posts/ipv6lan%E4%BE%A7%E5%8A%A8%E6%80%81%E5%AF%BB%E5%9D%80/e72d788e18723fc6a0d48ecc77185e97_hu8dc1ca501aae586cf2d13023df0caeb6_48909_480x0_resize_box_3.png 480w, https://blog.zooter.com.cn/posts/ipv6lan%E4%BE%A7%E5%8A%A8%E6%80%81%E5%AF%BB%E5%9D%80/e72d788e18723fc6a0d48ecc77185e97_hu8dc1ca501aae586cf2d13023df0caeb6_48909_1024x0_resize_box_3.png 1024w&#34;
	loading=&#34;lazy&#34;
	
		alt=&#34;无状态DHCPv6-DHCPv6应答消息&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;148&#34;
		data-flex-basis=&#34;355px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;DHCPv6服务器发送应答消息，其中包含地址参数，如图：DNS服务器地址。&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&#34;5-有状态dhcpv6&#34;&gt;5. 有状态DHCPv6&lt;/h2&gt;
&lt;p&gt;有状态DHCPv6地址分配方式即除了IPv6网关信息外，其他所有地址信息都从DHCPv6服务器获取，以下是有状态DHCPv6配置地址的流程：&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;客户端接口启动成功后，向&lt;code&gt;ff02::2&lt;/code&gt;发送RS消息。&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;&lt;img src=&#34;https://blog.zooter.com.cn/posts/ipv6lan%E4%BE%A7%E5%8A%A8%E6%80%81%E5%AF%BB%E5%9D%80/3b29200260366fd33d2f86cb355f1559.png&#34;
	width=&#34;938&#34;
	height=&#34;191&#34;
	srcset=&#34;https://blog.zooter.com.cn/posts/ipv6lan%E4%BE%A7%E5%8A%A8%E6%80%81%E5%AF%BB%E5%9D%80/3b29200260366fd33d2f86cb355f1559_huaa5d6eb0153c023c5122d797adc1bb42_18201_480x0_resize_box_3.png 480w, https://blog.zooter.com.cn/posts/ipv6lan%E4%BE%A7%E5%8A%A8%E6%80%81%E5%AF%BB%E5%9D%80/3b29200260366fd33d2f86cb355f1559_huaa5d6eb0153c023c5122d797adc1bb42_18201_1024x0_resize_box_3.png 1024w&#34;
	loading=&#34;lazy&#34;
	
		alt=&#34;有状态DHCPv6-RS消息&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;491&#34;
		data-flex-basis=&#34;1178px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;源地址是客户端本地链路地址，目的地址是&lt;code&gt;ff02::2&lt;/code&gt;所有IPv6路由器。&lt;/p&gt;
&lt;ol start=&#34;2&#34;&gt;
&lt;li&gt;IPv6路由器接收到RS消息后，立即向&lt;code&gt;ff02::1&lt;/code&gt;或客户端LLA发送RA消息。&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;&lt;img src=&#34;https://blog.zooter.com.cn/posts/ipv6lan%E4%BE%A7%E5%8A%A8%E6%80%81%E5%AF%BB%E5%9D%80/6ba2de6aadb6212109a977f3122b89de.png&#34;
	width=&#34;939&#34;
	height=&#34;946&#34;
	srcset=&#34;https://blog.zooter.com.cn/posts/ipv6lan%E4%BE%A7%E5%8A%A8%E6%80%81%E5%AF%BB%E5%9D%80/6ba2de6aadb6212109a977f3122b89de_hu2afaaabf1a7f7d50c617529bf18c3620_71101_480x0_resize_box_3.png 480w, https://blog.zooter.com.cn/posts/ipv6lan%E4%BE%A7%E5%8A%A8%E6%80%81%E5%AF%BB%E5%9D%80/6ba2de6aadb6212109a977f3122b89de_hu2afaaabf1a7f7d50c617529bf18c3620_71101_1024x0_resize_box_3.png 1024w&#34;
	loading=&#34;lazy&#34;
	
		alt=&#34;有状态DHCPv6-RA消息&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;99&#34;
		data-flex-basis=&#34;238px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;由于是有状态DHCPv6，A标志位置0，O和M标志位置1。表示建议客户端从DHCPv6服务器获取地址和地址配置。&lt;/p&gt;
&lt;ol start=&#34;3&#34;&gt;
&lt;li&gt;
&lt;p&gt;客户端使用RA报文中的IPv6网关地址。&lt;/p&gt;
&lt;p&gt;客户端从RA报文中只采用IPv6网关地址，其他信息从DHCPv6服务器获取。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;客户端发送DHCPv6恳求消息寻找DHCPv6服务器。&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;&lt;img src=&#34;https://blog.zooter.com.cn/posts/ipv6lan%E4%BE%A7%E5%8A%A8%E6%80%81%E5%AF%BB%E5%9D%80/6ec14e58818a0a85eb034437287360c8.png&#34;
	width=&#34;942&#34;
	height=&#34;850&#34;
	srcset=&#34;https://blog.zooter.com.cn/posts/ipv6lan%E4%BE%A7%E5%8A%A8%E6%80%81%E5%AF%BB%E5%9D%80/6ec14e58818a0a85eb034437287360c8_hu1603211c946f9fd64138eea5dd8dd2ac_64181_480x0_resize_box_3.png 480w, https://blog.zooter.com.cn/posts/ipv6lan%E4%BE%A7%E5%8A%A8%E6%80%81%E5%AF%BB%E5%9D%80/6ec14e58818a0a85eb034437287360c8_hu1603211c946f9fd64138eea5dd8dd2ac_64181_1024x0_resize_box_3.png 1024w&#34;
	loading=&#34;lazy&#34;
	
		alt=&#34;有状态DHCPv6-DHCPv6恳求消息&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;110&#34;
		data-flex-basis=&#34;265px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;&lt;code&gt;ff02::1:2&lt;/code&gt;表示所有DHCPv6服务器和中继服务器。&lt;/p&gt;
&lt;ol start=&#34;5&#34;&gt;
&lt;li&gt;DHCPv6服务器回应请求，发送DHCPv6通告消息。&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;&lt;img src=&#34;https://blog.zooter.com.cn/posts/ipv6lan%E4%BE%A7%E5%8A%A8%E6%80%81%E5%AF%BB%E5%9D%80/28d7ea4b78ee9340f558e1619564b0e2.png&#34;
	width=&#34;941&#34;
	height=&#34;947&#34;
	srcset=&#34;https://blog.zooter.com.cn/posts/ipv6lan%E4%BE%A7%E5%8A%A8%E6%80%81%E5%AF%BB%E5%9D%80/28d7ea4b78ee9340f558e1619564b0e2_hu8c0c7a4e7145d570c5c023c59f021882_64042_480x0_resize_box_3.png 480w, https://blog.zooter.com.cn/posts/ipv6lan%E4%BE%A7%E5%8A%A8%E6%80%81%E5%AF%BB%E5%9D%80/28d7ea4b78ee9340f558e1619564b0e2_hu8c0c7a4e7145d570c5c023c59f021882_64042_1024x0_resize_box_3.png 1024w&#34;
	loading=&#34;lazy&#34;
	
		alt=&#34;有状态DHCPv6-DHCPv6通告消息&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;99&#34;
		data-flex-basis=&#34;238px&#34;
	
&gt;&lt;/p&gt;
&lt;ol start=&#34;6&#34;&gt;
&lt;li&gt;客户端发送DHCPv6信息请求消息。&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;&lt;img src=&#34;https://blog.zooter.com.cn/posts/ipv6lan%E4%BE%A7%E5%8A%A8%E6%80%81%E5%AF%BB%E5%9D%80/2144b16db821876f67c3dcf3a8e4c1cb.png&#34;
	width=&#34;943&#34;
	height=&#34;791&#34;
	srcset=&#34;https://blog.zooter.com.cn/posts/ipv6lan%E4%BE%A7%E5%8A%A8%E6%80%81%E5%AF%BB%E5%9D%80/2144b16db821876f67c3dcf3a8e4c1cb_huc83268fb950ca5a817cc99593e187b0d_58898_480x0_resize_box_3.png 480w, https://blog.zooter.com.cn/posts/ipv6lan%E4%BE%A7%E5%8A%A8%E6%80%81%E5%AF%BB%E5%9D%80/2144b16db821876f67c3dcf3a8e4c1cb_huc83268fb950ca5a817cc99593e187b0d_58898_1024x0_resize_box_3.png 1024w&#34;
	loading=&#34;lazy&#34;
	
		alt=&#34;有状态DHCPv6-DHCPv6信息请求消息&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;119&#34;
		data-flex-basis=&#34;286px&#34;
	
&gt;&lt;/p&gt;
&lt;ol start=&#34;7&#34;&gt;
&lt;li&gt;
&lt;p&gt;DHCPv6服务器回应请求，发送DHCPv6应答消息。&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://blog.zooter.com.cn/posts/ipv6lan%E4%BE%A7%E5%8A%A8%E6%80%81%E5%AF%BB%E5%9D%80/d82033bfdcf38faa6cac8a56f86515f1.png&#34;
	width=&#34;938&#34;
	height=&#34;732&#34;
	srcset=&#34;https://blog.zooter.com.cn/posts/ipv6lan%E4%BE%A7%E5%8A%A8%E6%80%81%E5%AF%BB%E5%9D%80/d82033bfdcf38faa6cac8a56f86515f1_hufce51c50c22e09630c2b027aba98a310_52413_480x0_resize_box_3.png 480w, https://blog.zooter.com.cn/posts/ipv6lan%E4%BE%A7%E5%8A%A8%E6%80%81%E5%AF%BB%E5%9D%80/d82033bfdcf38faa6cac8a56f86515f1_hufce51c50c22e09630c2b027aba98a310_52413_1024x0_resize_box_3.png 1024w&#34;
	loading=&#34;lazy&#34;
	
		alt=&#34;有状态DHCPv6-DHCPv6应答消息&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;128&#34;
		data-flex-basis=&#34;307px&#34;
	
&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;在回应消息中，DHCPv6服务器提供了IP地址及其他的配置信息，如图：DNS服务器地址&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://blog.zooter.com.cn/posts/ipv6lan%E4%BE%A7%E5%8A%A8%E6%80%81%E5%AF%BB%E5%9D%80/698b82a7413ac5b30def26ea5f6bfa76.png&#34;
	width=&#34;1512&#34;
	height=&#34;576&#34;
	srcset=&#34;https://blog.zooter.com.cn/posts/ipv6lan%E4%BE%A7%E5%8A%A8%E6%80%81%E5%AF%BB%E5%9D%80/698b82a7413ac5b30def26ea5f6bfa76_hud24e86463095b0903bbb481bff9d0b62_146333_480x0_resize_box_3.png 480w, https://blog.zooter.com.cn/posts/ipv6lan%E4%BE%A7%E5%8A%A8%E6%80%81%E5%AF%BB%E5%9D%80/698b82a7413ac5b30def26ea5f6bfa76_hud24e86463095b0903bbb481bff9d0b62_146333_1024x0_resize_box_3.png 1024w&#34;
	loading=&#34;lazy&#34;
	
		alt=&#34;不同操作系统寻址方式支持列表&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;262&#34;
		data-flex-basis=&#34;630px&#34;
	
&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;a class=&#34;link&#34; href=&#34;https://www.packetmania.net/2020/12/01/IPv6-Addressing/&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;IPv6动态地址分配机制详解&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a class=&#34;link&#34; href=&#34;https://cshihong.github.io/2018/02/01/DHCPv6%E5%9F%BA%E7%A1%80/&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;DHCPv6基础&lt;/a&gt;&lt;/p&gt;
&lt;/blockquote&gt;
</description>
        </item>
        <item>
        <title>NAT类型简介</title>
        <link>https://blog.zooter.com.cn/posts/nat%E7%B1%BB%E5%9E%8B%E7%AE%80%E4%BB%8B/</link>
        <pubDate>Fri, 11 Mar 2022 00:03:02 -0800</pubDate>
        
        <guid>https://blog.zooter.com.cn/posts/nat%E7%B1%BB%E5%9E%8B%E7%AE%80%E4%BB%8B/</guid>
        <description>&lt;h1 id=&#34;nat类型简介&#34;&gt;NAT类型简介&lt;/h1&gt;
&lt;h2 id=&#34;1-简介&#34;&gt;1. 简介&lt;/h2&gt;
&lt;p&gt;网络地址转换，可以解决IPv4地址匮乏的问题，同时带有过滤的功能(防火墙)。&lt;/p&gt;
&lt;p&gt;PS：在IPv4时代NAT是非常受欢迎的，但随着IPv6的来临，应尽量避免使用NAT，所需的安全(防火墙)等功能应采取其他措施解决。&lt;/p&gt;
&lt;h2 id=&#34;2-术语&#34;&gt;2. 术语&lt;/h2&gt;
&lt;h3 id=&#34;21-内部tuple&#34;&gt;2.1 内部Tuple&lt;/h3&gt;
&lt;p&gt;指内部主机的私有地址和端口号所构成的二元组，即内部主机所发送报文的源地址、端口所构成的二元组。&lt;/p&gt;
&lt;h3 id=&#34;22-外部tuple&#34;&gt;2.2 外部Tuple&lt;/h3&gt;
&lt;p&gt;指内部Tuple经过NAT的源地址/端口转换之后，所获得的外部地址、端口所构成的二元组，即外部主机收到经NAT转换之后的报文时，它所看到的该报文的源地址（通常是NAT设备的地址）和源端口。&lt;/p&gt;
&lt;h3 id=&#34;23-目标tuple&#34;&gt;2.3 目标Tuple&lt;/h3&gt;
&lt;p&gt;指外部主机的地址、端口所构成的二元组，即内部主机所发送报文的目标地址、端口所构成的二元组。&lt;/p&gt;
&lt;h3 id=&#34;24-basic-nat基本nat&#34;&gt;2.4 Basic NAT（基本NAT）&lt;/h3&gt;
&lt;p&gt;只进行IP地址转换。在这种模式下，多台内部主机访问外部网络需要同等数量的公网IP地址，即需要一定数量的NAT地址池。&lt;/p&gt;
&lt;h3 id=&#34;25-natp网络地址-端口转换&#34;&gt;2.5 NATP（网络地址-端口转换）&lt;/h3&gt;
&lt;p&gt;NATP是在狭义NAT的基础上增加对端口的转换。这种模式下多台内部主机可经由一个公网IP地址访问外部网络，目前家用宽带主要的NAT模式。&lt;/p&gt;
&lt;h2 id=&#34;3-nat的类型&#34;&gt;3. NAT的类型&lt;/h2&gt;
&lt;h3 id=&#34;31-full-cone-nat锥形nat&#34;&gt;3.1 Full Cone NAT（锥形NAT）&lt;/h3&gt;
&lt;p&gt;所有来自同一 个内部Tuple X的请求均被NAT转换至同一个外部Tuple Y，而不管这些请求是不是属于同一个应用或者是多个应用的。除此之外，当X-Y的转换关系建立之后，任意外部主机均可随时将Y中的地址和端口作为目标地址和目标端口，向内部主机发送UDP报文，由于对外部请求的来源无任何限制，因此这种方式虽然足够简单，但却不那么安全。（任意的外部主机/port都能和先前内部节点被映射的外部Tuple进行通信）&lt;/p&gt;
&lt;h3 id=&#34;32-restricted-cone-nat受限的锥形nat&#34;&gt;3.2 Restricted Cone NAT（受限的锥形NAT）&lt;/h3&gt;
&lt;p&gt;它是Full Cone的受限版本：所有来自同一个内部Tuple X的请求均被NAT转换至同一个外部Tuple Y，这与Full Cone相同，但不同的是，只有当内部主机曾经发送过报文给外部主机（假设其IP地址为Z）后，外部主机才能以Y中的信息作为目标地址和目标端口，向内部主机发送UDP请求报文，这意味着，NAT设备只向内转发（目标地址/端口转换）那些来自于当前已知的外部主机的UDP报文，从而保障了外部请求来源的安全性。（IP相同，port随便，就能和先前内部节点被映射的外部Tuple进行通信）&lt;/p&gt;
&lt;h3 id=&#34;33-port-restricted-cone-nat严格限制的锥形nat&#34;&gt;3.3 Port Restricted Cone NAT（严格限制的锥形NAT）&lt;/h3&gt;
&lt;p&gt;它是Restricted Cone NAT的进一步受限版。只有当内部主机曾经发送过报文给外部主机（假设其IP地址为Z且端口为P）之后，外部主机才能以Y中的信息作为目标地址和目标端 口，向内部主机发送UDP报文，同时，其请求报文的源端口必须为P，这一要求进一步强化了对外部报文请求来源的限制，从而较Restrictd Cone更具安全性 （ip,port都得一样；只能用先前内部节点被映射的外部Tuple与内部节点进行通信））&lt;/p&gt;
&lt;h3 id=&#34;34-symmetric-nat对称nat&#34;&gt;3.4 Symmetric NAT（对称NAT）&lt;/h3&gt;
&lt;p&gt;在Cone NAT中，NAT转换映射关系仅与内部Tuple和外部Tuple相关，与目标Tuple无关。而在Symmetric NAT中，即使内部Tuple和外部Tuple相同，但目标Tuple不同，在此情况下将建立两条转换映射关系。此外，NAT的过滤方式与Port Restricted Cone相同。&lt;/p&gt;
&lt;hr&gt;
&lt;p&gt;&lt;a class=&#34;link&#34; href=&#34;https://www.cnblogs.com/my_life/articles/1908552.html&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;NAT的四种类型及类型检测 - bw_0927 - 博客园&lt;/a&gt;&lt;/p&gt;
</description>
        </item>
        <item>
        <title>802.11 kvr协议简述</title>
        <link>https://blog.zooter.com.cn/posts/802.11-kvr/</link>
        <pubDate>Fri, 11 Mar 2022 10:37:45 +0800</pubDate>
        
        <guid>https://blog.zooter.com.cn/posts/802.11-kvr/</guid>
        <description>&lt;h1 id=&#34;80211-kvr协议简述&#34;&gt;802.11 kvr协议简述&lt;/h1&gt;
&lt;h2 id=&#34;1-80211k&#34;&gt;1. 802.11k&lt;/h2&gt;
&lt;p&gt;802.11k协议的功能是Radio Resource Measurment，简单说就是提供找到最好的AP的信息。&lt;/p&gt;
&lt;p&gt;在WLAN中，终端设备总是倾向于连接信号最好的那个AP，而在实际应用中，这种逻辑可能会造成某个AP被过度使用，而信号稍弱的AP则没有怎么用到，从而导致网络的整体利用效率下降。实现802.11k协议的无线网络中，如果信号最好的AP已经满载，则终端设备会连接到信号稍弱的那个AP。&lt;/p&gt;
&lt;p&gt;协议步骤：&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;AP决定要踢掉某个终端设备&lt;/li&gt;
&lt;li&gt;通知终端设备变换到另一个AP&lt;/li&gt;
&lt;li&gt;终端设备请求周围AP的列表&lt;/li&gt;
&lt;li&gt;AP给出site report&lt;/li&gt;
&lt;li&gt;终端设备根据site report连到某个AP&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&#34;2-80211v&#34;&gt;2. 802.11v&lt;/h2&gt;
&lt;p&gt;802.11v是802.11协议族的WNM（Wireless Network Management）标准，802.11v协议允许终端设备交换网络拓扑的信息，包括射频环境。&lt;/p&gt;
&lt;p&gt;802.11v描述了WNM的增强，包括：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Network assisted Power Savings：网络辅助节能，帮助终端设备睡眠更长时间，比如，手机等设备通过每隔一段时间跟AP通讯一次来确保跟AP没有断开&lt;/li&gt;
&lt;li&gt;Network assisted Roaming：网络辅助漫游，允许WLAN发送信息给终端，来确保终端能连接更好的AP。&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;这可以带来两点好处：&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;负载均衡&lt;/li&gt;
&lt;li&gt;让信号不好的终端设备更换AP&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&#34;3-80211r&#34;&gt;3. 802.11r&lt;/h2&gt;
&lt;p&gt;802.11r的功能是快速BSS切换（FT，Fast Basic Service Set Transition），也称为快速漫游（fast roaming），是802.11协议的补充。&lt;/p&gt;
&lt;p&gt;在802.11协议中，AP的切换是由设备控制的（其逻辑是：在能连接到的信号中，挑选信号最好的那个连接，连接一直持续到信号低于一个阈值（通常非常弱）才会断开，然后继续反复）。&lt;/p&gt;
&lt;p&gt;在802.11的初期，切换（handoff）这个操作是非常简单的，一共只有4个握手信息需要传递，但是随着发展，802.11i，802.11X，802.11e等协议的加入，握手的信息越来越多，导致切换AP的时间越来越长。&lt;/p&gt;
&lt;p&gt;802.11r通过重新简化（越来越复杂的）安全握手协议，来实现FT。&lt;/p&gt;
</description>
        </item>
        
    </channel>
</rss>
